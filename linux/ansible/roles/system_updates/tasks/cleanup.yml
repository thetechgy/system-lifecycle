---
# APT cleanup tasks (run after other updates)

- name: Remove unused packages (autoremove)
  ansible.builtin.apt:
    autoremove: true

- name: Clean package cache (autoclean)
  ansible.builtin.apt:
    autoclean: true
  when: not (_compat_apt_full_clean | default(apt_full_clean))

- name: Clean package cache (full clean)
  ansible.builtin.command: apt-get clean
  when: _compat_apt_full_clean | default(apt_full_clean)
  changed_when: false  # Idempotent cleanup operation
